@use "sass:meta";
@use "sass:map";

///
/// Registers a single CSS Custom Property via the Properties & Values API.
/// Accepts either:
/// - a map: ("syntax": "<color>", "initial": currentColor, "inherits": false)
/// - or explicit keyword arguments via a map provided with merge utilities.
///
/// Supported keys:
/// - syntax: string value describing the syntax
/// - initial or initial-value: default value for the property
/// - inherits: boolean flag (defaults to true)
///
@mixin register-property($name, $definition) {
    $config: if(meta.type-of($definition) == "map", $definition, ());

    $syntax: map.get($config, "syntax");
    $initial: if(
        map.has-key($config, "initial-value"),
        map.get($config, "initial-value"),
        map.get($config, "initial")
    );
    $inherits: if(map.has-key($config, "inherits"), map.get($config, "inherits"), true);

    @property #{$name} {
        @if $syntax != null { syntax: #{$syntax}; }
        @if $inherits != null { inherits: $inherits; }
        @if $initial != null { initial-value: #{$initial}; }
    }
}

///
/// Registers multiple CSS Custom Properties at once.
/// Accepts any number of maps. Each map entry should follow the format used by `register-property`.
///
@mixin register-properties($bundles...) {
    @each $bundle in $bundles {
        @if meta.type-of($bundle) == "map" {
            @each $name, $definition in $bundle {
                @include register-property($name, $definition);
            }
        } @else if $bundle != null {
            @warn "register-properties expects map entries, received #{meta.type-of($bundle)}.";
        }
    }
}

