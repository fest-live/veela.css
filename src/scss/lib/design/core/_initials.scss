@use "../core/color" as color;

@mixin structural-shell(
    $prefix,
    $gap: null,
    $padding: null,
    $radius: var(--radius-md),
    $border-width: 1px,
    $border-style: solid,
    $border-color: transparent
) {
    @if $gap != null {
        --#{$prefix}-gap: #{$gap};
    }

    @if $padding != null {
        --#{$prefix}-padding: #{$padding};
    }

    --#{$prefix}-radius: #{$radius};
    --#{$prefix}-border: #{$border-width} #{$border-style};
    --#{$prefix}-border-color: #{$border-color};
    --#{$prefix}-border-width: #{$border-width};
    --#{$prefix}-border-style: #{$border-style};
    --#{$prefix}-border-radius: #{$radius};
    --#{$prefix}-border-radius-top-left: #{$radius};
    --#{$prefix}-border-radius-top-right: #{$radius};
    --#{$prefix}-border-radius-bottom-left: #{$radius};
    --#{$prefix}-border-radius-bottom-right: #{$radius};
}

@mixin initial-component-tokens() {
    // Component defaults
    --card-padding: var(--padding-lg);
    --card-gap: var(--gap-md);
    --card-radius: #{md3-radius(lg)};
    --card-avatar-size: var(--avatar-size);

    --form-radius: #{md3-radius(md)};
    --form-padding: var(--padding-md);
    --form-gap: var(--gap-sm);

    --button-radius: #{md3-radius(full)};
    --button-padding-x: var(--padding-lg);
    --button-padding-y: var(--padding-sm);

    --nav-gap: var(--gap-sm);
    --nav-padding: var(--padding-sm);
    --nav-radius: #{md3-radius(sm)};

    // -------------------------------------------------------------------------
    // Component tokens
    // -------------------------------------------------------------------------
    --avatar-size: clamp(32px, 6cqi, 48px);
    --avatar-size-lg: clamp(40px, 8cqi, 64px);

    --icon-size-sm: clamp(0.9rem, 1.2cqi, 1.1rem);
    --icon-size-md: clamp(1.1rem, 1.4cqi, 1.3rem);
    --icon-size-lg: clamp(1.4rem, 1.8cqi, 1.7rem);
    --icon-color: currentColor;

    --card-avatar-size: var(--avatar-size);

    --button-radius: var(--radius-full);
    --button-padding-x: var(--padding-lg);
    --button-padding-y: var(--padding-sm);

    --nav-gap: var(--gap-md);
    --nav-padding: var(--padding-md);
    --nav-radius: var(--radius-md);
}

@mixin initial-input-properties() {
    // -------------------------------------------------------------------------
    // Form controls 路 inputs
    // -------------------------------------------------------------------------
    --input-radius: var(--radius-full);
    --input-gap: var(--gap-sm);

    --input-padding: var(--padding-md);
    --input-padding-block: var(--padding-sm);
    --input-padding-inline: var(--padding-lg, 1rem);
    --input-padding-inline-start: var(--padding-lg, 1rem);
    --input-padding-inline-end: var(--padding-lg, 1rem);

    --input-text-color: var(--on-surface-color, currentColor);
    --input-placeholder-color: color-mix(in oklch, var(--input-text-color) 32%, transparent);
    --input-helper-color: color-mix(in oklch, var(--input-text-color) 68%, transparent);

    --input-border-width: 1px;
    --input-border-color: color-mix(in oklch, var(--on-surface-color, currentColor) 20%, transparent);
    --input-border-hover: color-mix(in oklch, var(--on-surface-color, currentColor) 30%, transparent);
    --input-border-focus: color-mix(
        in oklch,
        var(--input-border-hover) 40%,
        color-mix(in oklch, var(--current, currentColor) 30%, transparent)
    );
    --input-border-error: var(--error, currentColor);
    --input-border-disabled: color-mix(in oklch, var(--input-border-color) 35%, transparent);
    --input-border-readonly: color-mix(in oklch, var(--input-border-color) 55%, transparent);
    --input-border-checked: color-mix(in oklch, var(--surface-color, currentColor) 80%, transparent);
    --input-border-autofill: color-mix(in oklch, var(--input-border-color) 80%, transparent);

    --input-surface-color: color-mix(in oklch, var(--surface-color, transparent) 96%, var(--on-surface-color, transparent));
    --input-surface-hover: color-mix(in oklch, var(--input-surface-color) 90%, var(--input-border-focus) 10%);
    --input-surface-focus: color-mix(in oklch, var(--input-surface-color) 88%, var(--input-border-focus) 12%);
    --input-surface-error: color-mix(in oklch, var(--input-surface-color) 88%, var(--input-border-error) 12%);
    --input-surface-disabled: color-mix(in oklch, var(--input-surface-color) 96%, transparent 4%);
    --input-surface-readonly: color-mix(in oklch, var(--input-surface-color) 96%, transparent 4%);
    --input-surface-autofill: color-mix(in oklch, var(--input-surface-color) 94%, transparent 6%);
    --input-surface: var(--input-surface-color, var(--surface-color, currentColor));
    --input-color: var(--input-surface-color, var(--surface-color, currentColor));

    --input-shadow: 0 1px 2px color-mix(in oklch, var(--md-shadow, #000) 12%, transparent);
    --input-shadow-hover: 0 1px 3px color-mix(in oklch, var(--md-shadow, #000) 18%, transparent);
    --input-shadow-focus: 0 0 0 1px color-mix(in oklch, var(--input-border-focus) 32%, transparent),
        0 0 0 4px color-mix(in oklch, var(--input-border-focus) 12%, transparent);
    --input-shadow-error: 0 0 0 1px color-mix(in oklch, var(--input-border-error) 32%, transparent),
        0 0 0 4px color-mix(in oklch, var(--input-border-error) 12%, transparent);

    --input-focus-ring-offset: 2px;

    --input-selection-color: var(--on-surface-color, currentColor);
    --input-selection-on-color: var(--surface-color, currentColor);

    --input-icon-color: color-mix(in oklch, var(--input-text-color) 82%, transparent);
    --input-icon-size: var(--icon-size-md);

    --input-helper-spacing: var(--space-xs, 0.5rem);
    --input-label-color: color-mix(in oklch, var(--input-text-color) 92%, transparent);
    --input-min-block-size: 2.75rem;
    --input-min-inline-size: 0px;
    --input-max-inline-size: 100%;
    --input-inline-size: fit-content;
    --input-line-height: 1.4;
    --input-font-weight: inherit;
    --input-letter-spacing: 0.01em;
    --input-cursor: text;

    --input-text-disabled: color-mix(in oklch, var(--input-text-color) 55%, transparent);
    --input-text-readonly: color-mix(in oklch, var(--input-text-color) 70%, transparent);
    --input-text-autofill: color-mix(in oklch, var(--input-text-color) 65%, transparent);
}

@mixin initial-option-properties() {
    // -------------------------------------------------------------------------
    // Form controls 路 options
    // -------------------------------------------------------------------------
    --option-border-inline-size: 1px;
    --option-padding-block: var(--padding-sm);
    --option-padding-inline: calc(var(--padding-lg, 1rem) * 0.75);

    --option-border-color: color-mix(in oklch, var(--input-border-color) 70%, transparent);
    --option-border-hover: color-mix(in oklch, var(--option-border-color) 70%, var(--input-border-focus) 30%);
    --option-border-focus: var(--input-border-focus);
    --option-border-checked: var(--input-border-focus);

    --option-text-color: var(--input-text-color, var(--on-surface-color, currentColor));
    --option-text-hover: var(--option-text-color);
    --option-text-active: var(--option-text-color);
    --option-text-checked: var(--input-selection-on-color, var(--surface-color, currentColor));
    --option-text-focus: var(--input-border-focus);

    --option-surface-color: var(--input-surface-color, var(--surface-color, currentColor));
    --option-surface-hover: color-mix(in oklch, var(--option-surface-color) 88%, var(--on-surface-color, currentColor) 12%);
    --option-surface-active: color-mix(in oklch, var(--option-surface-color) 84%, var(--on-surface-color, currentColor) 16%);
    --option-surface-checked: color-mix(in oklch, var(--option-surface-color) 10%, var(--on-surface-color, currentColor) 90%);

    --option-outline-width: 2px;
    --option-outline-offset: -2px;
    --option-outline-color: color-mix(in oklch, var(--on-surface-color, currentColor) 80%, transparent);

    --option-color: var(--option-surface-color);
    --option-hover-color: var(--option-surface-hover);
    --option-active-color: var(--option-surface-active);
    --option-checked-color: var(--option-surface-checked);
}

@mixin initial-select-properties() {
    // -------------------------------------------------------------------------
    // Form controls 路 selects
    // -------------------------------------------------------------------------
    --select-gap: var(--gap-sm);
    --select-indicator-size: var(--icon-size-sm, 1.125rem);

    --select-indicator-color: var(--input-text-color, var(--option-text-color, currentColor));
    --select-text-color: var(--input-text-color, var(--option-text-color, currentColor));

    --select-color: var(--input-surface-color, var(--option-color, currentColor));
    --select-hover-color: var(--input-hover-color, var(--option-hover-color, currentColor));

    --select-surface-color: var(--input-surface-color, var(--option-color, currentColor));
    --select-surface-hover: var(--input-hover-color, var(--option-hover-color, currentColor));
}

@mixin initial-checkbox-properties() {
    // -------------------------------------------------------------------------
    // Form controls 路 checkboxes
    // -------------------------------------------------------------------------
    --checkbox-size: 1.25rem;
    --checkbox-radius: var(--radius-sm);
    --checkbox-border-width: 1px;

    --checkbox-surface: var(--input-surface, color-mix(in oklch, var(--surface-color, currentColor) 96%, var(--on-surface-color, currentColor)));
    --checkbox-surface-hover: color-mix(in oklch, var(--checkbox-surface) 88%, var(--on-surface-color, currentColor) 12%);
    --checkbox-surface-checked: color-mix(in oklch, var(--checkbox-surface) 10%, var(--on-surface-color, currentColor) 12%);
    --checkbox-surface-disabled: color-mix(in oklch, var(--checkbox-surface) 96%, transparent 4%);

    --checkbox-border-color: var(--input-border-color);
    --checkbox-border-hover: var(--input-border-hover);
    --checkbox-border-focus: var(--input-border-focus);
    --checkbox-border-checked: var(--input-border-focus);
    --checkbox-border-disabled: var(--input-border-disabled);

    --checkbox-shadow: var(--input-shadow);
    --checkbox-shadow-hover: var(--input-shadow-hover);
    --checkbox-shadow-focus: var(--input-shadow-focus);

    --checkbox-icon-color: var(--input-icon-color);
    --checkbox-icon-checked: var(--input-selection-on-color);
}

@mixin initial-form-controls() {
    // -------------------------------------------------------------------------
    // Form controls
    // -------------------------------------------------------------------------
    --form-radius: var(--radius-full);
    --form-padding: var(--padding-md);
    --form-gap: var(--gap-sm);

    @include initial-input-properties();
    @include initial-option-properties();
    @include initial-select-properties();
    @include initial-checkbox-properties();
}

@mixin initial-structural-elements() {
    // -------------------------------------------------------------------------
    // Surfaces & structural elements
    // -------------------------------------------------------------------------
    --accordion-radius: var(--radius-lg);
    --accordion-open-color-shade: var(--surface-opacity-emphasis);
    --accordion-open-border: 1px solid;
    --accordion-transition: var(--transition-colors);

    --empty-state-padding: var(--padding-2xl);
    --empty-state-radius: var(--radius-lg);
    --empty-state-border: 1px dashed color-mix(
        in oklch,
        var(
            --c2-on-surface(
                var(--scrollbar-tint),
                var(--current, var(--color-on-surface, var(--md-on-surface, #1c1b1f)))
            ),
            #{color.md3-var(outline-variant)}
        ) l c h / var(--border-opacity-dashed)
    );
    --empty-state-min-block-size: var(--space-2xl);

    @include structural-shell(
        "surface",
        null,
        null,
        var(--radius-md),
        1px,
        solid,
        transparent
    );

    @include structural-shell(
        "card",
        var(--gap-md),
        var(--padding-md),
        var(--radius-md),
        var(--surface-border-width, 1px),
        var(--surface-border-style, solid),
        var(--surface-border-color, transparent)
    );

    @include structural-shell(
        "panel",
        var(--gap-md),
        var(--padding-md),
        var(--radius-md),
        var(--surface-border-width, 1px),
        var(--surface-border-style, solid),
        var(--surface-border-color, transparent)
    );
}

@mixin initial-properties() {
    @include initial-component-tokens();
    @include initial-form-controls();
    @include initial-structural-elements();
}
