@use "sass:list";
@use "sass:map";
@use "sass:math";
@use "sass:meta";
@use "sass:string";

@use "utils" as _;
@use "shadow" as _shadow;

//
// Space scale
$md3-space-scale: (
    2xs: clamp(0.1875rem, 0.4cqi + 0.05rem, 0.25rem),
    xs: clamp(0.25rem, 0.45cqi + 0.06rem, 0.5rem),
    sm: clamp(0.5rem, 0.6cqi + 0.1rem, 0.75rem),
    md: clamp(0.75rem, 0.8cqi + 0.18rem, 1rem),
    lg: clamp(1rem, 1cqi + 0.24rem, 1.5rem),
    xl: clamp(1.5rem, 1.4cqi + 0.32rem, 2rem),
    2xl: clamp(2rem, 2cqi + 0.4rem, 2.75rem),
    3xl: clamp(2.75rem, 2.6cqi + 0.6rem, 3.5rem),
    4xl: clamp(3.5rem, 3cqi + 0.8rem, 4.5rem),
);

//
// Radius scale
$md3-radius-scale: (
    xs: clamp(0.25rem, 0.6cqi, 0.375rem),
    sm: clamp(0.5rem, 0.9cqi, 0.75rem),
    md: clamp(0.75rem, 1cqi, 1rem),
    lg: clamp(0.85rem, 1.2cqi, 1.2rem),
    xl: clamp(1rem, 1.5cqi, 1.4rem),
    full: 9999px,
);

//
// Radius aliases
$md3-radius-aliases: (
    xs: extra-small,
    sm: small,
    md: medium,
    lg: large,
    xl: extra-large,
    full: full,
);

//
// Shape scale
$md3-shape-scale: (
    corner-none: 0,
    extra-small: clamp(0.25rem, 0.6cqi, 0.375rem),
    extra-small-top: clamp(0.25rem, 0.6cqi, 0.375rem) clamp(0.25rem, 0.6cqi, 0.375rem) 0 0,
    small: clamp(0.5rem, 0.9cqi, 0.75rem),
    small-top: clamp(0.5rem, 0.9cqi, 0.75rem) clamp(0.5rem, 0.9cqi, 0.75rem) 0 0,
    medium: clamp(0.75rem, 1.2cqi, 1rem),
    large: clamp(1rem, 1.5cqi, 1.5rem),
    large-top: clamp(1rem, 1.5cqi, 1.5rem) clamp(1rem, 1.5cqi, 1.5rem) 0 0,
    large-end: clamp(1rem, 1.5cqi, 1.5rem) clamp(1rem, 1.5cqi, 1.5rem) 0 0,
    extra-extra-large: clamp(2rem, 2.4cqi, 2.5rem),
    extra-large: clamp(1.75rem, 2.4cqi, 2.25rem),
    extra-large-top: clamp(1.75rem, 2.4cqi, 2.25rem) clamp(1.75rem, 2.4cqi, 2.25rem) 0 0,
    extra-large-bottom: 0 0 clamp(1.75rem, 2.4cqi, 2.25rem) clamp(1.75rem, 2.4cqi, 2.25rem),
    full: 9999px,
);

//
// Radius aliases
$md3-radius-aliases: (
    3xs: extra-small,
    2xs: extra-small,
    xs: extra-small,
    sm: small,
    md: medium,
    lg: large,
    xl: extra-large,
    2xl: extra-large,
    3xl: extra-large,
    4xl: extra-large,
    full: full,
);


//
// Icon sizes
$md3-icon-sizes: (
    xs: clamp(0.75rem, 0.35cqi + 0.65rem, 0.9rem),
    sm: clamp(0.95rem, 0.4cqi + 0.85rem, 1.1rem),
    md: clamp(1.25rem, 0.45cqi + 1.1rem, 1.45rem),
    lg: clamp(1.5rem, 0.6cqi + 1.3rem, 1.75rem),
    xl: clamp(2rem, 0.8cqi + 1.65rem, 2.25rem),
    2xl: clamp(2.5rem, 1cqi + 2.25rem, 3rem),
    18xs: extra-small,
    19xs: extra-small,
    20xs: extra-small,
    21xs: extra-small,
    22xs: extra-small,
    23xs: extra-small,
    24xs: extra-small,
    25xs: extra-small,
    26xs: extra-small,
    27xs: extra-small,
    28xs: extra-small,
    29xs: extra-small,
    30xs: extra-small,
    31xs: extra-small,
    full: full,
);

//
// Avatar sizes
$md3-avatar-sizes: (
    sm: clamp(2.25rem, 1cqi + 2rem, 2.75rem),
    md: clamp(2.75rem, 1.4cqi + 2.4rem, 3.5rem),
    lg: clamp(3.5rem, 1.6cqi + 3rem, 4.5rem),
);


//
// Space function
@function md3-space($token) {
    @return _.md3-fetch($md3-space-scale, $token, "space token");
}

//
// Radius function
@function md3-radius($token) {
    @if map.has-key($md3-radius-aliases, $token) {
        $alias: map.get($md3-radius-aliases, $token);
        @return map.get($md3-radius-scale, $alias);
    }

    @return _.md3-fetch($md3-radius-scale, $token, "radius token");

    @error "Unknown MD3 radius token `#{$token}`. Available: #{map.keys($md3-radius-scale)}";
}

//
// Gap function
@function md3-gap($token) { @return md3-space($token); }

//
// Export gap vars mixin
@mixin md3-export-gap-vars() {
    @each $token, $value in $md3-space-scale {
        --gap-#{$token}: #{$value};
    }
}

//
// Padding function
@function md3-padding($token) { @return md3-space($token); }

//
// Export padding vars mixin
@mixin md3-export-padding-vars() {
    @each $token, $value in $md3-space-scale {
        --padding-#{$token}: #{$value};
    }
}

//
// Radius function
@function md3-shape($token) {
    @if map.has-key($md3-shape-scale, $token) {
        @return map.get($md3-shape-scale, $token);
    }

    @if map.has-key($md3-radius-aliases, $token) {
        $alias: map.get($md3-radius-aliases, $token);
        @return map.get($md3-shape-scale, $alias);
    }

    @error "Unknown MD3 radius token `#{$token}`. Available: #{map.keys($md3-shape-scale)}";
}

//
// State function
@function md3-opacity-state($state) {
    @return _.md3-fetch($md3-state-opacity, $state, "state token");
}

//
// Icon size function
@function md3-icon-size($token: md) {
    @return _.md3-fetch($md3-icon-sizes, $token, "icon size");
}

//
// Avatar size function
@function md3-avatar-size($token: md) {
    @return _.md3-fetch($md3-avatar-sizes, $token, "avatar size");
}

//
// Export layout vars mixin
@mixin md3-export-density-vars() {
    @each $token, $value in $md3-space-scale {
        --space-#{$token}: #{$value};
        --gap-#{$token}: #{$value};
        --padding-#{$token}: #{$value};
    }

    @each $token, $value in $md3-shape-scale {
        --radius-#{$token}: #{$value};
    }
}

//
// Export layout vars mixin
@mixin md3-export-layout-vars() {
    --card-padding: var(--padding-lg);
    --card-gap: var(--gap-md);
    --card-radius: #{md3-radius(lg)};
    --card-avatar-size: #{md3-avatar-size(md)};

    --form-radius: #{md3-radius(md)};
    --form-padding: var(--padding-md);
    --form-gap: var(--gap-sm);

    --button-radius: #{md3-radius(full)};
    --button-padding-x: var(--padding-lg);
    --button-padding-y: var(--padding-sm);

    --nav-gap: var(--gap-sm);
    --nav-padding: var(--padding-sm);
    --nav-radius: #{md3-radius(sm)};

    --icon-size-xs: #{md3-icon-size(xs)};
    --icon-size-sm: #{md3-icon-size(sm)};
    --icon-size-md: #{md3-icon-size(md)};
    --icon-size-lg: #{md3-icon-size(lg)};
    --icon-size-xl: #{md3-icon-size(xl)};

    --avatar-size-sm: #{md3-avatar-size(sm)};
    --avatar-size: #{md3-avatar-size(md)};
    --avatar-size-lg: #{md3-avatar-size(lg)};

    --text-opacity-disabled: #{md3-state(disabled)};
}


//
// Spacing variables
$spacing-xs: #{md3-space(xs)};
$spacing-sm: #{md3-space(sm)};
$spacing-md: #{md3-space(md)};
$spacing-lg: #{md3-space(lg)};
$spacing-xl: #{md3-space(xl)};
$spacing-2xl: #{md3-space(2xl)};
$spacing-3xl: #{md3-space(3xl)};
$spacing-4xl: #{md3-space(4xl)};

//
// Border radius variables
$border-radius-sm: #{md3-radius(sm)};
$border-radius-md: #{md3-radius(md)};
$border-radius-lg: #{md3-radius(lg)};
$border-radius-xl: #{md3-radius(xl)};
$border-radius-2xl: #{md3-radius(2xl)};
$border-radius-3xl: #{md3-radius(3xl)};
$border-radius-4xl: #{md3-radius(4xl)};
$border-radius-full: #{md3-radius(full)};

//
// Z-index variables
$z-dropdown: 1000;
$z-sticky: 1020;
$z-fixed: 1030;
$z-modal-backdrop: 1040;
$z-modal: 1050;
$z-popover: 1060;
$z-tooltip: 1070;

//
// Breakpoint variables
$breakpoint-sm: 40rem;
$breakpoint-md: 60rem;
$breakpoint-lg: 75rem;
$breakpoint-xl: 90rem;
$breakpoint-2xl: 105rem;

//
// Container max width
$container-max-width: min(100%, 110rem);

//
// Backdrop blur variables
$backdrop-blur-sm: blur(6px);
$backdrop-blur-md: blur(12px);
$backdrop-blur-lg: blur(18px);

//
// UI radius variables
$ui-radius-sm: #{md3-radius(sm)} !default;
$ui-radius-md: #{md3-radius(md)} !default;
$ui-radius-lg: #{md3-radius(lg)} !default;
$ui-radius-xl: #{md3-radius(xl)} !default;
$ui-radius-2xl: #{md3-radius(2xl)} !default;
$ui-radius-3xl: #{md3-radius(3xl)} !default;
$ui-radius-4xl: #{md3-radius(4xl)} !default;
$ui-radius-full: #{md3-radius(full)} !default;
$ui-border-width: 1px !default;

//
// UI spacing variables
$ui-spacing-2xs: #{md3-space(2xs)} !default;
$ui-spacing-xs: #{md3-space(xs)} !default;
$ui-spacing-sm: #{md3-space(sm)} !default;
$ui-spacing-md: #{md3-space(md)} !default;
$ui-spacing-lg: #{md3-space(lg)} !default;
$ui-spacing-xl: #{md3-space(xl)} !default;
$ui-spacing-2xl: #{md3-space(2xl)} !default;
$ui-spacing-3xl: #{md3-space(3xl)} !default;
$ui-spacing-4xl: #{md3-space(4xl)} !default;

//
// UI titlebar height
$ui-titlebar-height: 32px !default;
$ui-font-title-size: #{md3-type("title-small", size)} !default;
$ui-font-subtitle-size: #{md3-type("label-large", size)} !default;

//
// Mobile width
$mobile-width: 9in;

//
// Is touch
$is-touch: "screen and (hover: none) and (pointer: coarse)";
$is-not-wide: "(width < #{$mobile-width})";
$is-desktop: "(((hover: hover) or (pointer: fine)) and ((width >= #{$mobile-width}) or (orientation: landscape)))";
$is-mobile: "not #{$is-desktop}";
$is-windowed: "@container u2-windowed #{$is-not-wide}";



//
// Export layout vars mixin
@mixin md3-export-layout-vars() {
    @each $token, $value in $md3-space-scale {
        --space-#{$token}: #{$value};
        --gap-#{$token}: #{$value};
        --padding-#{$token}: #{$value};
    }

    @each $token, $value in $md3-space-scale {
        --radius-#{$token}: #{md3-radius($token)};
    }

    @each $token, $value in $md3-space-scale {
        --radius-#{$token}: #{$value};
    }

    @each $alias, $token in $md3-radius-aliases {
        --shape-#{$alias}: #{md3-shape($token)};
    }

    @each $token, $value in $md3-shape-scale {
        --shape-#{$token}: #{$value};
    }

    --radius-full: #{md3-radius(full)};
}
