@use "veela-lib" as *;

//
@mixin validation-state($color, $border-opacity: var(--border-opacity-strong), $bg-opacity: 0.04) {
    border-color: oklch(from $color l c h / $border-opacity);
    background-color: oklch(from $color l c h / $bg-opacity);
}

//
@mixin validation-warning { @include validation-state(var(--color-warning)); }
@mixin validation-success { @include validation-state(var(--color-success)); }
@mixin validation-error   { @include validation-state(var(--color-error)); }

// Dedicated colorization utility classes
// These classes apply semantic color variants and states to elements
@layer ux-colors {

    // =============================================================================
    // INPUT STATE VARIANTS
    // =============================================================================

    :where(input, textarea, select) {
        // Success state
        &.state-success,
        &.is-success,
        &[data-state="success"] {
            --current: var(--color-success);
            @include validation-success;
        }

        // Warning state
        &.state-warning,
        &.is-warning,
        &[data-state="warning"] {
            --current: var(--color-warning);
            @include validation-warning;
        }

        // Error state
        &.state-error,
        &.is-error,
        &.state-invalid,
        &.is-invalid,
        &[data-state="error"],
        &[data-state="invalid"] {
            --current: var(--color-error, var(--color-danger));
            @include validation-error;
        }

        // Valid state
        &.state-valid,
        &.is-valid,
        &[data-state="valid"] {
            --current: var(--color-success);
            @include validation-success;
        }
    }


    // =============================================================================
    // COLOR VARIANT CLASSES
    // =============================================================================

    .color-primary { --current: var(--color-primary); }
    .color-secondary { --current: var(--color-secondary); }
    .color-accent { --current: var(--color-accent); }
    .color-success { --current: var(--color-success); }
    .color-warning { --current: var(--color-warning); }
    .color-danger { --current: var(--color-danger); }
    .color-info { --current: var(--color-info); }

    // =============================================================================
    // SURFACE COLORIZATION CLASSES
    // =============================================================================

    .surface {
        @include solid-colorize("&", ("shade": var(--surface-opacity-default), "tint": 0.0, "scope": "selector"));
    }

    .surface-subtle {
        @include solid-colorize("&", ("shade": var(--surface-opacity-subtle), "tint": 0.0, "scope": "selector"));
    }

    .surface-muted {
        @include solid-colorize("&", ("shade": var(--surface-opacity-muted), "tint": 0.0, "scope": "selector"));
    }

    .surface-emphasis {
        @include solid-colorize("&", ("shade": var(--surface-opacity-emphasis), "tint": 0.0, "scope": "selector"));
    }

    .surface-strong {
        @include solid-colorize("&", ("shade": var(--surface-opacity-strong), "tint": 0.0, "scope": "selector"));
    }

    // =============================================================================
    // INTERACTIVE SURFACE CLASSES
    // =============================================================================

    .surface-interactive {
        @include surface-interactive(var(--surface-opacity-default));

        &:hover { --color-shade: calc(var(--surface-opacity-default) + var(--hover-lift, 0.03)); }
        &:active { --color-shade: calc(var(--surface-opacity-default) + var(--active-lift, 0.05)); }
        &:focus-visible { --color-shade: calc(var(--surface-opacity-default) + var(--focus-lift, 0.02)); }
    }

    .surface-interactive-subtle {
        @include surface-interactive(var(--surface-opacity-subtle));

        &:hover { --color-shade: calc(var(--surface-opacity-subtle) + var(--hover-lift, 0.03)); }
        &:active { --color-shade: calc(var(--surface-opacity-subtle) + var(--active-lift, 0.05)); }
    }

    .surface-interactive-emphasis {
        @include surface-interactive(var(--surface-opacity-emphasis));

        &:hover { --color-shade: calc(var(--surface-opacity-emphasis) + var(--hover-lift, 0.03)); }
        &:active { --color-shade: calc(var(--surface-opacity-emphasis) + var(--active-lift, 0.05)); }
    }


    // =============================================================================
    // TEXT COLOR CLASSES
    // =============================================================================

    .text-primary {
        @include text-color(var(--text-tint-primary));
    }

    .text-secondary {
        @include text-color(var(--text-tint-secondary));
    }

    .text-muted {
        @include text-color(var(--text-tint-muted));
    }

    .text-disabled {
        @include text-color(var(--text-tint-disabled));
        opacity: 0.6;
        cursor: not-allowed;
    }

    // =============================================================================
    // VALIDATION STATE CLASSES
    // =============================================================================

    .state-success {
        --current: var(--color-success);
        @include validation-success;
    }

    .state-warning {
        --current: var(--color-warning);
        @include validation-warning;
    }

    .state-error {
        --current: var(--color-error, var(--color-danger));
        @include validation-error;
    }

    .state-invalid {
        --current: var(--color-error, var(--color-danger));
        @include validation-error;
    }

    .state-valid {
        --current: var(--color-success);
        @include validation-success;
    }

    // =============================================================================
    // COMBINED COLOR + SURFACE CLASSES
    // =============================================================================

    @each $color-name, $color-var in (
        "primary": var(--color-primary),
        "secondary": var(--color-secondary),
        "accent": var(--color-accent),
        "success": var(--color-success),
        "warning": var(--color-warning),
        "danger": var(--color-danger),
        "info": var(--color-info)
    ) {
        .#{$color-name}-surface {
            --current: #{$color-var};
            @include solid-colorize("&", ("shade": var(--surface-opacity-default), "tint": 0.0, "scope": "selector"));
        }

        .#{$color-name}-surface-interactive {
            --current: #{$color-var};
            @include surface-interactive(var(--surface-opacity-default));

            &:hover { --color-shade: calc(var(--surface-opacity-default) + var(--hover-lift, 0.03)); }
            &:active { --color-shade: calc(var(--surface-opacity-default) + var(--active-lift, 0.05)); }
            &:focus-visible { --color-shade: calc(var(--surface-opacity-default) + var(--focus-lift, 0.02)); }
        }
    }



    // =============================================================================
    // BUTTON MODIFIERS & VARIANTS
    // =============================================================================

    :where(button) {
        @include button-filled();

        // Palette overrides -------------------------------------------------
        &.btn-primary,
        &[data-variant="primary"] {
            --md-button-bg: var(--md-primary);
            --md-button-on: var(--md-on-primary);
            --md-button-state-color: var(--md-primary);
            --md-button-outline-color: var(--md-primary);
        }

        &.btn-secondary,
        &[data-variant="secondary"] {
            --md-button-bg: var(--md-secondary);
            --md-button-on: var(--md-on-secondary);
            --md-button-state-color: var(--md-secondary);
            --md-button-outline-color: var(--md-secondary);
        }

        &.btn-tertiary,
        &.btn-accent,
        &[data-variant="tertiary"] {
            --md-button-bg: var(--md-tertiary);
            --md-button-on: var(--md-on-tertiary);
            --md-button-state-color: var(--md-tertiary);
            --md-button-outline-color: var(--md-tertiary);
        }

        &.btn-surface,
        &[data-variant="surface"] {
            --md-button-bg: var(--md-surface);
            --md-button-on: var(--md-on-surface);
            --md-button-state-color: var(--md-primary);
            --md-button-outline-color: var(--md-outline);
        }

        &.btn-success,
        &:is(.save, .submit, .confirm) {
            --md-button-bg: var(--color-success);
            --md-button-on: var(--md-on-surface);
            --md-button-state-color: var(--color-success);
            --md-button-outline-color: var(--color-success);
        }

        &.btn-danger,
        &:is(.cancel, .delete, .remove) {
            --md-button-bg: var(--color-danger);
            --md-button-on: var(--md-on-surface);
            --md-button-state-color: var(--color-danger);
            --md-button-outline-color: var(--color-danger);
        }

        &.btn-warning,
        &:is(.warning) {
            --md-button-bg: var(--color-warning);
            --md-button-on: var(--md-on-surface);
            --md-button-state-color: var(--color-warning);
            --md-button-outline-color: var(--color-warning);
        }

        &.btn-info,
        &:is(.info) {
            --md-button-bg: var(--color-info);
            --md-button-on: var(--md-on-surface);
            --md-button-state-color: var(--color-info);
            --md-button-outline-color: var(--color-info);
        }

        // Variant mixins ----------------------------------------------------
        &.btn-filled,
        &.filled {
            @include button-filled(primary, false);
        }

        &.btn-elevated,
        &.elevated {
            @include button-elevated(primary, false);
        }

        &.btn-tonal,
        &.tonal {
            @include button-tonal(secondary-container, secondary, false);
        }

        &.btn-tonal.btn-primary,
        &.btn-tonal-primary {
            --md-button-bg: var(--md-primary-container);
            --md-button-on: var(--md-on-primary-container);
            --md-button-state-color: var(--md-primary);
            @include button-tonal(primary-container, primary, false);
        }

        &.btn-tonal.btn-secondary,
        &.btn-tonal-secondary {
            --md-button-bg: var(--md-secondary-container);
            --md-button-on: var(--md-on-secondary-container);
            --md-button-state-color: var(--md-secondary);
            @include button-tonal(secondary-container, secondary, false);
        }

        &.btn-tonal.btn-tertiary,
        &.btn-tonal-tertiary {
            --md-button-bg: var(--md-tertiary-container);
            --md-button-on: var(--md-on-tertiary-container);
            --md-button-state-color: var(--md-tertiary);
            @include button-tonal(tertiary-container, tertiary, false);
        }

        &.btn-outlined,
        &.outlined {
            --md-button-on: var(--md-button-on, var(--md-primary));
            --md-button-outline-color: var(--md-button-outline-color, var(--md-primary));
            --md-button-state-color: var(--md-button-state-color, var(--md-primary));
            @include button-outlined(primary, false);
        }

        &.btn-outlined.btn-secondary {
            --md-button-on: var(--md-secondary);
            --md-button-outline-color: var(--md-secondary);
            --md-button-state-color: var(--md-secondary);
            @include button-outlined(primary, false);
        }

        &.btn-outlined.btn-tertiary,
        &.btn-outlined.btn-accent {
            --md-button-on: var(--md-tertiary);
            --md-button-outline-color: var(--md-tertiary);
            --md-button-state-color: var(--md-tertiary);
            @include button-outlined(primary, false);
        }

        &.btn-text,
        &.btn-link,
        &.btn-ghost,
        &.text {
            --md-button-on: var(--md-button-on, var(--md-primary));
            --md-button-state-color: var(--md-button-state-color, var(--md-primary));
            @include button-text(primary, false);
        }

        &.btn-text.btn-secondary {
            --md-button-on: var(--md-secondary);
            --md-button-state-color: var(--md-secondary);
            @include button-text(primary, false);
        }

        &.btn-text.btn-tertiary,
        &.btn-text.btn-accent {
            --md-button-on: var(--md-tertiary);
            --md-button-state-color: var(--md-tertiary);
            @include button-text(primary, false);
        }

        &.btn-icon,
        &.icon-only {
            @include button-icon();
        }
    }

}
